# Test isokinetic algorithm, with one fixed atom
# As this test case uses many atoms, the input variable prtatlist
# is tested here to show only information about a few of them

prtatlist 1 2 3 5 8 13 21 *0
chkexit 0
#Definition of acell changing
 acell 3*12.0
#Primitive cell sc
 rprim 1.0 0.0 0.0 0.0 1.0 0.0 0.0 0.0 1.0
 ntypat 1           # There is one type of atom
 znucl 5           # This is Boron

 #Definition of the atoms(four atoms)
 natom 32
 typat 32*1

 #Definition of the planewave basis set
 ecut 10.0
 #Definition of the SCF procedure
 nstep 50
 toldfe 1.0d-6
 diemac 5.0
 diemix 0.5
 dielng 0.5
 #Thomas-Fermi
 tfkinfunc 1
 #Definition of exchange correlation no
 ixc 0
 #Molecular dynamics
 ionmov 12
 dtion 10
 ntime 10
 natfix 1
 iatfix 1
 mdtemp 1000 1000 # Only the first temperature is used in the case of the isokinetic algorithm
 #Electronic population (Fermi-Dirac)
 occopt 0
 nband 1
  kptopt 0
 nkpt 1
 occ 160
 tphysel 0.025724516
 #Timing info
 timopt -1
xred
9.69352483749e-05 6.55898630619e-05 0.000155466413498
0.249872799325 0.249979644747 -2.70123302937e-05
0.249997580157 0.00016469181776 0.249943109339
-5.40672421455e-05 0.24985907675 0.250108477402
-2.49001644552e-06 2.63837035745e-06 0.499996171425
0.250043261722 0.250035367689 0.500021115656
0.250068437415 0.000100119686127 0.750034876245
0.000128875434399 0.249799681306 0.75015920552
3.15946698189e-05 0.50025727098 -2.31237471104e-05
0.249958039835 0.749989032416 -8.18451285362e-05
0.250020926629 0.499918421781 0.250265359974
-1.26428678632e-05 0.749974890989 0.250015431109
-0.000165465080738 0.499965698111 0.500030003753
0.249896028137 0.750008961695 0.499988857749
0.250041221267 0.500014831972 0.749951073503
-9.95837926865e-05 0.749849160624 0.749855715251
0.500019242015 -8.20537731051e-06 7.88066804409e-05
0.750086307997 0.249805338836 5.27735054493e-05
0.750047513282 8.55033755302e-05 0.250217415428
0.500014728546 0.250088756472 0.250030093896
0.500153932047 -0.000124121141434 0.500006467412
0.749939009547 0.25001183497 0.500094740748
0.749923089707 0.000213498330116 0.750001784612
0.499990387648 0.250087046689 0.750001508184
0.500071335441 0.499859288383 8.19714844227e-05
0.750065190047 0.74996530782 -0.000123725545406
0.749925601071 0.499997500053 0.250062730801
0.500024506417 0.749823052979 0.250077276784
0.499952220696 0.499961013168 0.499999989802
0.75021397748 0.749946163112 0.500102528203
0.750157079816 0.49989762789 0.750045461079
0.500196432698 0.750059558135 0.750198977625

#%%<BEGIN TEST_INFO>
#%% [setup]
#%% executable = abinit
#%% [files]
#%% files_to_test = 
#%%   t21.out, tolnlines = 0, tolabs = 0.000e+00, tolrel = 0.000e+00
#%% psp_files = 05b.soft_tm
#%% [paral_info]
#%% max_nprocs = 1
#%% [extra_info]
#%% authors = JF. Danel, L. Kazandjian, X. Gonze
#%% keywords = 
#%% description = 
#%%   Test of molecular dynamics of B atoms, in the isokinetic
#%%   ensemble, based on the Thomas-Fermi functional (very fast, even with 32 atoms).
#%%   Fix the position of one atom.
#%% topics = Recursion
#%%<END TEST_INFO>
