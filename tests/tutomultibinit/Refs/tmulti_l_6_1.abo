******************************************************************************************
                                Welcome to MULTIBINIT,                         
 a software platform designed for the construction and use of second-principles models
                   for lattice, spin and electron degrees of freedom.

.Version 9.8.1 of MULTIBINIT 
.(MPI version, prepared for a x86_64_linux_gnu9.3 computer) 

.Copyright (C) 1998-2022 ABINIT group . 
 MULTIBINIT comes with ABSOLUTELY NO WARRANTY.
 It is free software, and you are welcome to redistribute it
 under certain conditions (GNU General Public License,
 see ~abinit/COPYING or http://www.gnu.org/copyleft/gpl.txt).

 MULTIBINIT is a software project of the University of Liege
 (PHYTHEMA & NANOMAT groups), in collaboration with other partners.

-----------------------------------------------------------------------------------------

                          MULTIBINIT - LATTICE MODELS                   

 Project initiated and coordinated by Philippe GHOSEZ and his group at ULiege
   (Philippe.Ghosez@uliege.be).

 Main contributors: Alexandre MARTIN, Jordan BIEDER, Michael Marcus SCHMITT,
   Louis BASTOGNE, Xu HE, Alireza SASANI, Huazhang ZHANG, Subhadeep BANDYOPADHYAY,
   Philippe GHOSEZ.

 Technical support: Xu HE (X.He@uliege.be)

*****************************************************************************************



.Starting date : Wed 14 Dec 2022.
- ( at 14h57 )
  
-  nproc =    1

================================================================================

 Read the information in the reference structure in 
-/home/buildbot/ABINIT/alps_gnu_9.3_openmpi/xuhe_mbfix98/tests/tutomultibinit/Input/tmulti_l_6_DDB
 to initialize the multibinit input

================================================================================

 -outvars_multibinit: echo values of input variables ----------------------

 Flags : 
     ifcflag         1
   prt_model         4
     strcpli        -1
 Fit the coefficients :
         fit_coeff  1
 fit_generateCoeff  1
 fit_initializeDat  0
        fit_cutoff  5.60000000E+00
        fit_option  0
         fit_iatom  2
        fit_ncoeff  12
          fit_grid  1  1  1
         ts_option  0
    fit_rangePower  3  4
     fit_dispterms  1
    fit_anhaStrain  0
    fit_SPCoupling  1
      fit_SPC_maxS  1
 Miscellaneous information :
         asr         2
 Interatomic Force Constants Inputs :
      dipdip         1
dipdip_range         2         2         2
      ifcana         0
      ifcout   2000000
      natifc         5
       atifc         1   2   3   4   5
 Description of grid 1 :
        brav         1
       ngqpt         4         4         4
      nqshft         1
      q1shft
                     0.00000000E+00  0.00000000E+00  0.00000000E+00
 First list of wavevector (reduced coord.) :
       nph1l         1
       qph1l
                     0.00000000E+00  0.00000000E+00  0.00000000E+00    0.000E+00

================================================================================

 Read the DDB information of the reference system and perform some checks

 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)=  7.8411196  0.0000000  0.0000000  G(1)=  0.1275328  0.0000000  0.0000000
 R(2)=  0.0000000  7.8411196  0.0000000  G(2)=  0.0000000  0.1275328  0.0000000
 R(3)=  0.0000000  0.0000000  7.8411196  G(3)=  0.0000000  0.0000000  0.1275328
 Unit cell volume ucvol=  4.8209678E+02 bohr^3
 Angles (23,13,12)=  9.00000000E+01  9.00000000E+01  9.00000000E+01 degrees
 Now the whole DDB is in central memory

================================================================================

 Extraction of the energy of the structure (unit: Hartree)

 Energy  =       -1.343187819874E+02

================================================================================

 Dielectric Tensor and Effective Charges 


 anaddb : Zero the imaginary part of the Dynamical Matrix at Gamma,
   and impose the ASR on the effective charges 

 The violation of the charge neutrality conditions
 by the effective charges is as follows :
    atom        electric field
 displacement     direction
       1               1       -0.000507        0.000000
       1               2        0.000000        0.000000
       1               3        0.000000        0.000000
       2               1        0.000000        0.000000
       2               2       -0.000507        0.000000
       2               3        0.000000        0.000000
       3               1        0.000000        0.000000
       3               2        0.000000        0.000000
       3               3       -0.000507        0.000000

 Effective charge tensors after 
 imposition of the charge neutrality,
 and eventual restriction to some part :
   atom    displacement
         1         1    2.753751E+00    0.000000E+00    0.000000E+00
         1         2    0.000000E+00    2.753751E+00    0.000000E+00
         1         3    0.000000E+00    0.000000E+00    2.753751E+00
         2         1    5.816047E+00    0.000000E+00    0.000000E+00
         2         2    0.000000E+00    5.816047E+00    0.000000E+00
         2         3    0.000000E+00    0.000000E+00    5.816047E+00
         3         1   -2.019049E+00    0.000000E+00    0.000000E+00
         3         2    0.000000E+00   -4.531700E+00    0.000000E+00
         3         3    0.000000E+00    0.000000E+00   -2.019049E+00
         4         1   -4.531700E+00    0.000000E+00    0.000000E+00
         4         2    0.000000E+00   -2.019049E+00    0.000000E+00
         4         3    0.000000E+00    0.000000E+00   -2.019049E+00
         5         1   -2.019049E+00    0.000000E+00    0.000000E+00
         5         2    0.000000E+00   -2.019049E+00    0.000000E+00
         5         3    0.000000E+00    0.000000E+00   -4.531700E+00
 Now, the imaginary part of the dynamical matrix is zeroed

================================================================================

 Extraction of the stress tensor (unit: GPa) and forces (unit: Ha/bohr)

 Cartesian components of forces (hartree/bohr)

   1     0.00000000E+00  0.00000000E+00  0.00000000E+00
   2     0.00000000E+00  0.00000000E+00  0.00000000E+00
   3     0.00000000E+00  0.00000000E+00  0.00000000E+00
   4     0.00000000E+00  0.00000000E+00  0.00000000E+00
   5     0.00000000E+00  0.00000000E+00  0.00000000E+00

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)=  2.23642476E-11  sigma(3 2)=  0.00000000E+00
  sigma(2 2)=  2.23642563E-11  sigma(3 1)=  0.00000000E+00
  sigma(3 3)=  2.23642563E-11  sigma(2 1)=  0.00000000E+00


================================================================================

 Extraction of the clamped elastic tensor (unit:10^2GPa)

   3.4403978   0.8535133   0.8535134   0.0000000   0.0000001   0.0000004
   0.8535133   3.4403977   0.8535134   0.0000001   0.0000000   0.0000004
   0.8535133   0.8535133   3.4403975   0.0000001   0.0000001  -0.0000004
  -0.0000000   0.0000000   0.0000000   0.9606190   0.0000000   0.0000000
   0.0000000  -0.0000000   0.0000000   0.0000000   0.9606190   0.0000000
   0.0000000   0.0000000  -0.0000000   0.0000000   0.0000000   0.9606190

================================================================================

 Calculation of acoustic sum rule


================================================================================

 Calculation of the interatomic forces from DDB

       Homogeneous q point set in the B.Z.
 Grid q points  :       64
  1)   0.00000000E+00  0.00000000E+00  0.00000000E+00
  2)   2.50000000E-01  0.00000000E+00  0.00000000E+00
  3)   5.00000000E-01  0.00000000E+00  0.00000000E+00
  4)  -2.50000000E-01  0.00000000E+00  0.00000000E+00
  5)   0.00000000E+00  2.50000000E-01  0.00000000E+00
  6)   2.50000000E-01  2.50000000E-01  0.00000000E+00
  7)   5.00000000E-01  2.50000000E-01  0.00000000E+00
  8)  -2.50000000E-01  2.50000000E-01  0.00000000E+00
  9)   0.00000000E+00  5.00000000E-01  0.00000000E+00
 10)   2.50000000E-01  5.00000000E-01  0.00000000E+00
 11)   5.00000000E-01  5.00000000E-01  0.00000000E+00
 12)  -2.50000000E-01  5.00000000E-01  0.00000000E+00
 13)   0.00000000E+00 -2.50000000E-01  0.00000000E+00
 14)   2.50000000E-01 -2.50000000E-01  0.00000000E+00
 15)   5.00000000E-01 -2.50000000E-01  0.00000000E+00
 16)  -2.50000000E-01 -2.50000000E-01  0.00000000E+00
 17)   0.00000000E+00  0.00000000E+00  2.50000000E-01
 18)   2.50000000E-01  0.00000000E+00  2.50000000E-01
 19)   5.00000000E-01  0.00000000E+00  2.50000000E-01
 20)  -2.50000000E-01  0.00000000E+00  2.50000000E-01
 21)   0.00000000E+00  2.50000000E-01  2.50000000E-01
 22)   2.50000000E-01  2.50000000E-01  2.50000000E-01
 23)   5.00000000E-01  2.50000000E-01  2.50000000E-01
 24)  -2.50000000E-01  2.50000000E-01  2.50000000E-01
 25)   0.00000000E+00  5.00000000E-01  2.50000000E-01
 26)   2.50000000E-01  5.00000000E-01  2.50000000E-01
 27)   5.00000000E-01  5.00000000E-01  2.50000000E-01
 28)  -2.50000000E-01  5.00000000E-01  2.50000000E-01
 29)   0.00000000E+00 -2.50000000E-01  2.50000000E-01
 30)   2.50000000E-01 -2.50000000E-01  2.50000000E-01
 31)   5.00000000E-01 -2.50000000E-01  2.50000000E-01
 32)  -2.50000000E-01 -2.50000000E-01  2.50000000E-01
 33)   0.00000000E+00  0.00000000E+00  5.00000000E-01
 34)   2.50000000E-01  0.00000000E+00  5.00000000E-01
 35)   5.00000000E-01  0.00000000E+00  5.00000000E-01
 36)  -2.50000000E-01  0.00000000E+00  5.00000000E-01
 37)   0.00000000E+00  2.50000000E-01  5.00000000E-01
 38)   2.50000000E-01  2.50000000E-01  5.00000000E-01
 39)   5.00000000E-01  2.50000000E-01  5.00000000E-01
 40)  -2.50000000E-01  2.50000000E-01  5.00000000E-01
 41)   0.00000000E+00  5.00000000E-01  5.00000000E-01
 42)   2.50000000E-01  5.00000000E-01  5.00000000E-01
 43)   5.00000000E-01  5.00000000E-01  5.00000000E-01
 44)  -2.50000000E-01  5.00000000E-01  5.00000000E-01
 45)   0.00000000E+00 -2.50000000E-01  5.00000000E-01
 46)   2.50000000E-01 -2.50000000E-01  5.00000000E-01
 47)   5.00000000E-01 -2.50000000E-01  5.00000000E-01
 48)  -2.50000000E-01 -2.50000000E-01  5.00000000E-01
 49)   0.00000000E+00  0.00000000E+00 -2.50000000E-01
 50)   2.50000000E-01  0.00000000E+00 -2.50000000E-01
 51)   5.00000000E-01  0.00000000E+00 -2.50000000E-01
 52)  -2.50000000E-01  0.00000000E+00 -2.50000000E-01
 53)   0.00000000E+00  2.50000000E-01 -2.50000000E-01
 54)   2.50000000E-01  2.50000000E-01 -2.50000000E-01
 55)   5.00000000E-01  2.50000000E-01 -2.50000000E-01
 56)  -2.50000000E-01  2.50000000E-01 -2.50000000E-01
 57)   0.00000000E+00  5.00000000E-01 -2.50000000E-01
 58)   2.50000000E-01  5.00000000E-01 -2.50000000E-01
 59)   5.00000000E-01  5.00000000E-01 -2.50000000E-01
 60)  -2.50000000E-01  5.00000000E-01 -2.50000000E-01
 61)   0.00000000E+00 -2.50000000E-01 -2.50000000E-01
 62)   2.50000000E-01 -2.50000000E-01 -2.50000000E-01
 63)   5.00000000E-01 -2.50000000E-01 -2.50000000E-01
 64)  -2.50000000E-01 -2.50000000E-01 -2.50000000E-01

 The interatomic forces have been obtained

================================================================================

 Calculation of dynamical matrix for each ph1l points

  Phonon at Gamma, with non-analyticity in the
  direction (cartesian coordinates)  0.00000  0.00000  0.00000
 Phonon energies in Hartree :
   0.000000E+00  0.000000E+00  0.000000E+00  4.855216E-04  4.855216E-04
   4.855216E-04  8.565574E-04  8.565574E-04  8.565574E-04  9.382818E-04
   9.382818E-04  9.382818E-04  2.363951E-03  2.363951E-03  2.363951E-03
 Phonon frequencies in cm-1    :
-  0.000000E+00  0.000000E+00  0.000000E+00  1.065597E+02  1.065597E+02
-  1.065597E+02  1.879926E+02  1.879926E+02  1.879926E+02  2.059290E+02
-  2.059290E+02  2.059290E+02  5.188273E+02  5.188273E+02  5.188273E+02

================================================================================

 Calculation of the internal-strain  tensor

 Force-response internal strain tensor(Unit:Hartree/bohr)

 Atom dir   strainxx    strainyy    strainzz    strainyz    strainxz    strainxy
  1  x    -0.0000000   0.0000000   0.0000000  -0.0000000   0.0000000  -0.0000000
  1  y     0.0000000  -0.0000000   0.0000000  -0.0000000  -0.0000000  -0.0000000
  1  z     0.0000000   0.0000000   0.0000000  -0.0000000  -0.0000000  -0.0000000
  2  x     0.0000000  -0.0000000  -0.0000000  -0.0000000   0.0000000   0.0000000
  2  y     0.0000000   0.0000000  -0.0000000   0.0000000   0.0000000   0.0000000
  2  z    -0.0000000  -0.0000000   0.0000000   0.0000000   0.0000000  -0.0000000
  3  x    -0.0000000  -0.0000000  -0.0000000   0.0000000   0.0000000  -0.0000000
  3  y     0.0000000  -0.0000000   0.0000000   0.0000000   0.0000000   0.0000000
  3  z     0.0000000  -0.0000000  -0.0000000  -0.0000000   0.0000000   0.0000000
  4  x    -0.0000000   0.0000000   0.0000000   0.0000000   0.0000000   0.0000000
  4  y    -0.0000000  -0.0000000  -0.0000000   0.0000000   0.0000000  -0.0000000
  4  z    -0.0000000  -0.0000000  -0.0000000   0.0000000  -0.0000000   0.0000000
  5  x    -0.0000000  -0.0000000  -0.0000000   0.0000000  -0.0000000   0.0000000
  5  y    -0.0000000  -0.0000000  -0.0000000  -0.0000000   0.0000000   0.0000000
  5  z    -0.0000000   0.0000000  -0.0000000   0.0000000   0.0000000   0.0000000



 Bound for ifc SR:

 x=[ -2  2], y=[ -2  2] and z=[ -2  2]

================================================================================
 Generation of new ifc

 dipdip is set to one, the dipole-dipole interation is recompute.

 Bound for ifc (LR):

 x=[  0  1], y=[  0  1] and z=[  0  1]

 Computation of new dipole-dipole interaction.

 Impose acoustic sum rule on total ifc

================================================================================

================================================================================

 There is no file for the coefficients from polynomial fitting

================================================================================

-Reading the training-set file :
-/home/buildbot/ABINIT/alps_gnu_9.3_openmpi/xuhe_mbfix98/tests/tutomultibinit/Input/tmulti_l_6_HIST.nc


--------------------------------------------------------------------------------

 Starting Fit process

--------------------------------------------------------------------------------

 The coefficients for the fit around atom  2: Hf, will be generated

 364 coefficients generated 


 Goal function values at the begining of the fit process (eV^2/A^2):
   Energy          :   2.2780101689771812E-03
   Forces+Stresses :   3.9733623695669733E-02
   Forces          :   2.4711895759431803E-02
   Stresses        :   1.5021727936237930E-02

 N   Selecting          MSDE              MSDFS              MSDF              MSDS
    Coefficient      (eV^2/A^2)        (eV^2/A^2)        (eV^2/A^2)        (eV^2/A^2)
 1     362         3.0218143507E-03  2.5361517551E-02  1.9610735625E-02  5.7507819254E-03
 2     21          5.2474393977E-04  2.0833324572E-02  1.5132460946E-02  5.7008636263E-03
 3     331         5.2109881376E-04  1.7937166356E-02  1.2211480468E-02  5.7256858874E-03
 4     263         3.4978884787E-04  1.6263427214E-02  1.1761986012E-02  4.5014412022E-03
 5     268         4.1406112058E-04  1.5070000684E-02  1.2012362120E-02  3.0576385644E-03
 6     7           1.5183070698E-04  1.3942109253E-02  1.0846491448E-02  3.0956178052E-03
 7     145         1.6144479903E-04  1.3082297553E-02  1.0135821825E-02  2.9464757285E-03
 8     134         1.6206329217E-04  1.2657475692E-02  9.7165833551E-03  2.9408923369E-03
 9     272         1.7654005220E-04  1.2400556707E-02  9.7178924586E-03  2.6826642482E-03
 10    336         1.8332292087E-04  1.2147135160E-02  9.4429523365E-03  2.7041828235E-03
 11    358         1.7652991665E-04  1.1902597412E-02  9.4009401909E-03  2.5016572208E-03
 12    138         1.7493658871E-04  1.1685295009E-02  9.1861221049E-03  2.4991729040E-03

 Fitted coefficients at the end of the fit process:
 362 =>  -4.2783881075E-01 (Hf_y-O1_y)^2(eta_2)^1
 21 =>  -3.3276464410E-03 (Hf_x-O1_x)^2(Hf_z-O1_z)^1(Hf_y-O3_y)^1
 331 =>  -1.1878637879E-01 (Hf_y-O1_y)^2(Hf_y-O1_y[0 1 0])^1
 263 =>  -1.8035610799E-02 (Hf_x-O1_x)^1(Hf_y-O2_y)^1(eta_1)^1
 268 =>  -1.6019155874E-02 (Hf_x-O1_x)^2(eta_3)^1
 7 =>   1.9647811665E-03 (Hf_x-O1_x)^4
 145 =>  -1.4145340965E-02 (Hf_x-O1_x)^2(Hf_y-O1_y)^2
 134 =>   2.5874575949E-03 (Hf_x-O1_x)^2(Hf_z-O3_z)^1
 272 =>   5.0179299169E-03 (Hf_x-O1_x)^1(Hf_z-O2_z)^1(eta_4)^1
 336 =>   3.5345820000E-02 (Hf_y-O1_y)^3(Hf_y-O1_y[0 1 0])^1
 358 =>  -8.6418289927E-02 (Hf_y-O1_y)^2(eta_1)^1
 138 =>  -3.0147200326E-03 (Hf_x-O1_x)^1(Hf_y-O1_y)^1(Hf_y-O2_y)^1

 Goal function values at the end of the fit process (eV^2/A^2):
   Energy          :   1.7493658871165139E-04
   Forces+Stresses :   1.1685295008892586E-02
   Forces          :   9.1861221049251030E-03
   Stresses        :   2.4991729039674838E-03


================================================================================

 Generation of the xml file for the fitted polynomial in tmulti_l_6_1_coeffs.xml

================================================================================

-
- Proc.   0 individual time (sec): cpu=        346.3  wall=        347.4

================================================================================

+Total cpu time    346.314  and wall time    347.417 sec

 multibinit : the run completed succesfully.
